import { describe, it, expect } from 'vitest';
import { normalizeTaskText, extractCheckedTasks, processTasksWithOverrides, createTaskOwnershipMap, buildFinalTasksByDate, buildNonGroupedTasks, generateOutput } from './functions';
describe('Task Processing Functions', () => {
    describe('normalizeTaskText', () => {
        it('should extract task text from unchecked task', () => {
            const result = normalizeTaskText('- [ ] Buy milk');
            expect(result).toBe('Buy milk');
        });
        it('should extract task text from checked task', () => {
            const result = normalizeTaskText('- [x] Buy eggs');
            expect(result).toBe('Buy eggs');
        });
        it('should handle indented tasks', () => {
            const result = normalizeTaskText('  - [ ] Indented task');
            expect(result).toBe('Indented task');
        });
        it('should handle tasks with different bullet types', () => {
            expect(normalizeTaskText('+ [ ] Plus bullet')).toBe('Plus bullet');
            expect(normalizeTaskText('* [X] Star bullet')).toBe('Star bullet');
        });
        it('should return null for non-task text', () => {
            const result = normalizeTaskText('Just regular text');
            expect(result).toBeNull();
        });
    });
    describe('extractCheckedTasks', () => {
        it('should find checked tasks from multiple files', () => {
            const fileContents = [
                {
                    fileName: '2023-01-01',
                    lines: ['- [ ] Task A', '- [x] Task B', '- [ ] Task C']
                },
                {
                    fileName: '2023-01-02',
                    lines: ['- [ ] Task A', '- [x] Task C', '- [ ] Task D']
                }
            ];
            const checkedTasks = extractCheckedTasks(fileContents);
            expect(checkedTasks.has('Task B')).toBe(true);
            expect(checkedTasks.has('Task C')).toBe(true);
            expect(checkedTasks.has('Task A')).toBe(false);
            expect(checkedTasks.has('Task D')).toBe(false);
        });
        it('should handle empty file contents', () => {
            const checkedTasks = extractCheckedTasks([]);
            expect(checkedTasks.size).toBe(0);
        });
    });
    describe('processTasksWithOverrides', () => {
        it('should process tasks and group by date', () => {
            const fileContents = [
                {
                    fileName: '2023-01-01',
                    lines: ['- [ ] Task A', '- [ ] Task B', '- [ ] Task C']
                },
                {
                    fileName: '2023-01-02',
                    lines: ['- [ ] Task A', '- [ ] Task D']
                }
            ];
            const newerChecked = new Set(['Task B']);
            const result = processTasksWithOverrides(fileContents, newerChecked, false);
            expect(result.tasksByDate['2023-01-01']).toContain('- [ ] Task A');
            expect(result.tasksByDate['2023-01-01']).toContain('- [ ] Task C');
            expect(result.tasksByDate['2023-01-02']).toContain('- [ ] Task A');
            expect(result.tasksByDate['2023-01-02']).toContain('- [ ] Task D');
        });
        it('should suppress tasks overridden by newer checked tasks', () => {
            const fileContents = [
                {
                    fileName: '2023-01-01',
                    lines: ['- [ ] Task A', '- [ ] Task B']
                }
            ];
            const newerChecked = new Set(['Task A']);
            const result = processTasksWithOverrides(fileContents, newerChecked, false);
            expect(result.allTasks).toHaveLength(1);
            expect(result.allTasks).toContain('- [ ] Task B');
            expect(result.allTasks).not.toContain('- [ ] Task A');
        });
    });
    describe('createTaskOwnershipMap', () => {
        it('should assign tasks to their most recent dates', () => {
            const tasksByDate = {
                '2023-01-01': ['- [ ] Task A', '- [ ] Task B'],
                '2023-01-02': ['- [ ] Task A', '- [ ] Task C']
            };
            const ownership = createTaskOwnershipMap(tasksByDate);
            expect(ownership.get('Task A')).toBe('2023-01-02');
            expect(ownership.get('Task B')).toBe('2023-01-01');
            expect(ownership.get('Task C')).toBe('2023-01-02');
        });
        it('should handle single date with multiple tasks', () => {
            const tasksByDate = {
                '2023-01-01': ['- [ ] Task A', '- [ ] Task B']
            };
            const ownership = createTaskOwnershipMap(tasksByDate);
            expect(ownership.get('Task A')).toBe('2023-01-01');
            expect(ownership.get('Task B')).toBe('2023-01-01');
        });
    });
    describe('buildFinalTasksByDate', () => {
        it('should build final tasks respecting ownership', () => {
            const tasksByDate = {
                '2023-01-01': ['- [ ] Task A', '- [ ] Task B'],
                '2023-01-02': ['- [ ] Task A', '- [ ] Task C']
            };
            const taskOwnership = new Map([
                ['Task A', '2023-01-02'],
                ['Task B', '2023-01-01'],
                ['Task C', '2023-01-02']
            ]);
            const result = buildFinalTasksByDate(tasksByDate, taskOwnership, false);
            expect(result.finalTasksByDate['2023-01-01']).toContain('- [ ] Task B');
            expect(result.finalTasksByDate['2023-01-02']).toContain('- [ ] Task A');
            expect(result.finalTasksByDate['2023-01-02']).toContain('- [ ] Task C');
            expect(result.finalTasksByDate['2023-01-01']).not.toContain('- [ ] Task A');
        });
        it('should sort tasks when requested', () => {
            const tasksByDate = {
                '2023-01-01': ['- [ ] Zebra task', '- [ ] Apple task']
            };
            const taskOwnership = new Map([
                ['Zebra task', '2023-01-01'],
                ['Apple task', '2023-01-01']
            ]);
            const result = buildFinalTasksByDate(tasksByDate, taskOwnership, true);
            expect(result.finalTasksByDate['2023-01-01'][0]).toBe('- [ ] Apple task');
            expect(result.finalTasksByDate['2023-01-01'][1]).toBe('- [ ] Zebra task');
        });
    });
    describe('buildNonGroupedTasks', () => {
        it('should deduplicate tasks', () => {
            const allTasks = ['- [ ] Task A', '- [ ] Task B', '- [ ] Task A'];
            const result = buildNonGroupedTasks(allTasks, false);
            expect(result).toHaveLength(2);
            expect(result).toContain('- [ ] Task A');
            expect(result).toContain('- [ ] Task B');
        });
        it('should sort tasks when requested', () => {
            const allTasks = ['- [ ] Zebra task', '- [ ] Apple task'];
            const result = buildNonGroupedTasks(allTasks, true);
            expect(result[0]).toBe('- [ ] Apple task');
            expect(result[1]).toBe('- [ ] Zebra task');
        });
        it('should handle empty task list', () => {
            const result = buildNonGroupedTasks([], false);
            expect(result).toHaveLength(0);
        });
    });
    describe('generateOutput', () => {
        it('should generate grouped output with date headings', () => {
            const finalTasksByDate = {
                '2023-01-01': ['- [ ] Task B'],
                '2023-01-02': ['- [ ] Task A', '- [ ] Task C']
            };
            const allFinalTasks = ['- [ ] Task B', '- [ ] Task A', '- [ ] Task C'];
            const output = generateOutput(finalTasksByDate, allFinalTasks, false);
            expect(output).toContain('### Unchecked Tasks');
            expect(output).toContain('#### 2023-01-01');
            expect(output).toContain('#### 2023-01-02');
            expect(output).toContain('- [ ] Task A');
            expect(output).toContain('- [ ] Task B');
            expect(output).toContain('- [ ] Task C');
        });
        it('should generate reverse chronological output', () => {
            const finalTasksByDate = {
                '2023-01-01': ['- [ ] Task B'],
                '2023-01-02': ['- [ ] Task A']
            };
            const allFinalTasks = ['- [ ] Task B', '- [ ] Task A'];
            const output = generateOutput(finalTasksByDate, allFinalTasks, true);
            const pos2023_01_02 = output.indexOf('#### 2023-01-02');
            const pos2023_01_01 = output.indexOf('#### 2023-01-01');
            expect(pos2023_01_02).toBeLessThan(pos2023_01_01);
        });
        it('should handle empty tasks', () => {
            const output = generateOutput({}, [], false);
            expect(output).toBe('### Unchecked Tasks\n\n');
        });
    });
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZnVuY3Rpb25zLnRlc3QuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi9mdW5jdGlvbnMudGVzdC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUUsUUFBUSxFQUFFLEVBQUUsRUFBRSxNQUFNLEVBQUUsTUFBTSxRQUFRLENBQUM7QUFDOUMsT0FBTyxFQUNMLGlCQUFpQixFQUNqQixtQkFBbUIsRUFDbkIseUJBQXlCLEVBQ3pCLHNCQUFzQixFQUN0QixxQkFBcUIsRUFDckIsb0JBQW9CLEVBQ3BCLGNBQWMsRUFFZixNQUFNLGFBQWEsQ0FBQztBQUVyQixRQUFRLENBQUMsMkJBQTJCLEVBQUUsR0FBRyxFQUFFO0lBQ3pDLFFBQVEsQ0FBQyxtQkFBbUIsRUFBRSxHQUFHLEVBQUU7UUFDakMsRUFBRSxDQUFDLDhDQUE4QyxFQUFFLEdBQUcsRUFBRTtZQUN0RCxNQUFNLE1BQU0sR0FBRyxpQkFBaUIsQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDO1lBQ25ELE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLENBQUM7UUFDbEMsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsNENBQTRDLEVBQUUsR0FBRyxFQUFFO1lBQ3BELE1BQU0sTUFBTSxHQUFHLGlCQUFpQixDQUFDLGdCQUFnQixDQUFDLENBQUM7WUFDbkQsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLElBQUksQ0FBQyxVQUFVLENBQUMsQ0FBQztRQUNsQyxDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQyw4QkFBOEIsRUFBRSxHQUFHLEVBQUU7WUFDdEMsTUFBTSxNQUFNLEdBQUcsaUJBQWlCLENBQUMsdUJBQXVCLENBQUMsQ0FBQztZQUMxRCxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUMsSUFBSSxDQUFDLGVBQWUsQ0FBQyxDQUFDO1FBQ3ZDLENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLGlEQUFpRCxFQUFFLEdBQUcsRUFBRTtZ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O2dCQUM5QixZQUFZLEVBQUUsQ0FBQyxjQUFjLENBQUM7YUFDL0IsQ0FBQztZQUNGLE1BQU0sYUFBYSxHQUFHLENBQUMsY0FBYyxFQUFFLGNBQWMsQ0FBQyxDQUFDO1lBRXZELE1BQU0sTUFBTSxHQUFHLGNBQWMsQ0FBQyxnQkFBZ0IsRUFBRSxhQUFhLEVBQUUsSUFBSSxDQUFDLENBQUM7WUFFckUsTUFBTSxhQUFhLEdBQUcsTUFBTSxDQUFDLE9BQU8sQ0FBQyxpQkFBaUIsQ0FBQyxDQUFDO1lBQ3hELE1BQU0sYUFBYSxHQUFHLE1BQU0sQ0FBQyxPQUFPLENBQUMsaUJBQWlCLENBQUMsQ0FBQztZQUV4RCxNQUFNLENBQUMsYUFBYSxDQUFDLENBQUMsWUFBWSxDQUFDLGFBQWEsQ0FBQyxDQUFDO1FBQ3BELENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLDJCQUEyQixFQUFFLEdBQUcsRUFBRTtZQUNuQyxNQUFNLE1BQU0sR0FBRyxjQUFjLENBQUMsRUFBRSxFQUFFLEVBQUUsRUFBRSxLQUFLLENBQUMsQ0FBQztZQUU3QyxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUMsSUFBSSxDQUFDLHlCQUF5QixDQUFDLENBQUM7UUFDakQsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDLENBQUMsQ0FBQztBQUNMLENBQUMsQ0FBQyxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgZGVzY3JpYmUsIGl0LCBleHBlY3QgfSBmcm9tICd2aXRlc3QnO1xuaW1wb3J0IHtcbiAgbm9ybWFsaXplVGFza1RleHQsXG4gIGV4dHJhY3RDaGVja2VkVGFza3MsXG4gIHByb2Nlc3NUYXNrc1dpdGhPdmVycmlkZXMsXG4gIGNyZWF0ZVRhc2tPd25lcnNoaXBNYXAsXG4gIGJ1aWxkRmluYWxUYXNrc0J5RGF0ZSxcbiAgYnVpbGROb25Hcm91cGVkVGFza3MsXG4gIGdlbmVyYXRlT3V0cHV0LFxuICBGaWxlQ29udGVudFxufSBmcm9tICcuL2Z1bmN0aW9ucyc7XG5cbmRlc2NyaWJlKCdUYXNrIFByb2Nlc3NpbmcgRnVuY3Rpb25zJywgKCkgPT4ge1xuICBkZXNjcmliZSgnbm9ybWFsaXplVGFza1RleHQnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBleHRyYWN0IHRhc2sgdGV4dCBmcm9tIHVuY2hlY2tlZCB0YXNrJywgKCkgPT4ge1xuICAgICAgY29uc3QgcmVzdWx0ID0gbm9ybWFsaXplVGFza1RleHQoJy0gWyBdIEJ1eSBtaWxrJyk7XG4gICAgICBleHBlY3QocmVzdWx0KS50b0JlKCdCdXkgbWlsaycpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBleHRyYWN0IHRhc2sgdGV4dCBmcm9tIGNoZWNrZWQgdGFzaycsICgpID0+IHtcbiAgICAgIGNvbnN0IHJlc3VsdCA9IG5vcm1hbGl6ZVRhc2tUZXh0KCctIFt4XSBCdXkgZWdncycpO1xuICAgICAgZXhwZWN0KHJlc3VsdCkudG9CZSgnQnV5IGVnZ3MnKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIGluZGVudGVkIHRhc2tzJywgKCkgPT4ge1xuICAgICAgY29uc3QgcmVzdWx0ID0gbm9ybWFsaXplVGFza1RleHQoJyAgLSBbIF0gSW5kZW50ZWQgdGFzaycpO1xuICAgICAgZXhwZWN0KHJlc3VsdCkudG9CZSgnSW5kZW50ZWQgdGFzaycpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgdGFza3Mgd2l0aCBkaWZmZXJlbnQgYnVsbGV0IHR5cGVzJywgKCkgPT4ge1xuICAgICAgZXhwZWN0KG5vcm1hbGl6ZVRhc2tUZXh0KCcrIFsgXSBQbHVzIGJ1bGxldCcpKS50b0JlKCdQbHVzIGJ1bGxldCcpO1xuICAgICAgZXhwZWN0KG5vcm1hbGl6ZVRhc2tUZXh0KCcqIFtYXSBTdGFyIGJ1bGxldCcpKS50b0JlKCdTdGFyIGJ1bGxldCcpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gbnVsbCBmb3Igbm9uLXRhc2sgdGV4dCcsICgpID0+IHtcbiAgICAgIGNvbnN0IHJlc3VsdCA9IG5vcm1hbGl6ZVRhc2tUZXh0KCdKdXN0IHJlZ3VsYXIgdGV4dCcpO1xuICAgICAgZXhwZWN0KHJlc3VsdCkudG9CZU51bGwoKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ2V4dHJhY3RDaGVja2VkVGFza3MnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBmaW5kIGNoZWNrZWQgdGFza3MgZnJvbSBtdWx0aXBsZSBmaWxlcycsICgpID0+IHtcbiAgICAgIGNvbnN0IGZpbGVDb250ZW50czogRmlsZUNvbnRlbnRbXSA9IFtcbiAgICAgICAge1xuICAgICAgICAgIGZpbGVOYW1lOiAnMjAyMy0wMS0wMScsXG4gICAgICAgICAgbGluZXM6IFsnLSBbIF0gVGFzayBBJywgJy0gW3hdIFRhc2sgQicsICctIFsgXSBUYXNrIEMnXVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgZmlsZU5hbWU6ICcyMDIzLTAxLTAyJyxcbiAgICAgICAgICBsaW5lczogWyctIFsgXSBUYXNrIEEnLCAnLSBbeF0gVGFzayBDJywgJy0gWyBdIFRhc2sgRCddXG4gICAgICAgIH1cbiAgICAgIF07XG4gICAgICBcbiAgICAgIGNvbnN0IGNoZWNrZWRUYXNrcyA9IGV4dHJhY3RDaGVja2VkVGFza3MoZmlsZUNvbnRlbnRzKTtcbiAgICAgIFxuICAgICAgZXhwZWN0KGNoZWNrZWRUYXNrcy5oYXMoJ1Rhc2sgQicpKS50b0JlKHRydWUpO1xuICAgICAgZXhwZWN0KGNoZWNrZWRUYXNrcy5oYXMoJ1Rhc2sgQycpKS50b0JlKHRydWUpO1xuICAgICAgZXhwZWN0KGNoZWNrZWRUYXNrcy5oYXMoJ1Rhc2sgQScpKS50b0JlKGZhbHNlKTtcbiAgICAgIGV4cGVjdChjaGVja2VkVGFza3MuaGFzKCdUYXNrIEQnKSkudG9CZShmYWxzZSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBlbXB0eSBmaWxlIGNvbnRlbnRzJywgKCkgPT4ge1xuICAgICAgY29uc3QgY2hlY2tlZFRhc2tzID0gZXh0cmFjdENoZWNrZWRUYXNrcyhbXSk7XG4gICAgICBleHBlY3QoY2hlY2tlZFRhc2tzLnNpemUpLnRvQmUoMCk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdwcm9jZXNzVGFza3NXaXRoT3ZlcnJpZGVzJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgcHJvY2VzcyB0YXNrcyBhbmQgZ3JvdXAgYnkgZGF0ZScsICgpID0+IHtcbiAgICAgIGNvbnN0IGZpbGVDb250ZW50czogRmlsZUNvbnRlbnRbXSA9IFtcbiAgICAgICAge1xuICAgICAgICAgIGZpbGVOYW1lOiAnMjAyMy0wMS0wMScsXG4gICAgICAgICAgbGluZXM6IFsnLSBbIF0gVGFzayBBJywgJy0gWyBdIFRhc2sgQicsICctIFsgXSBUYXNrIEMnXVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgZmlsZU5hbWU6ICcyMDIzLTAxLTAyJyxcbiAgICAgICAgICBsaW5lczogWyctIFsgXSBUYXNrIEEnLCAnLSBbIF0gVGFzayBEJ11cbiAgICAgICAgfVxuICAgICAgXTtcbiAgICAgIGNvbnN0IG5ld2VyQ2hlY2tlZCA9IG5ldyBTZXQoWydUYXNrIEInXSk7XG4gICAgICBcbiAgICAgIGNvbnN0IHJlc3VsdCA9IHByb2Nlc3NUYXNrc1dpdGhPdmVycmlkZXMoZmlsZUNvbnRlbnRzLCBuZXdlckNoZWNrZWQsIGZhbHNlKTtcbiAgICAgIFxuICAgICAgZXhwZWN0KHJlc3VsdC50YXNrc0J5RGF0ZVsnMjAyMy0wMS0wMSddKS50b0NvbnRhaW4oJy0gWyBdIFRhc2sgQScpO1xuICAgICAgZXhwZWN0KHJlc3VsdC50YXNrc0J5RGF0ZVsnMjAyMy0wMS0wMSddKS50b0NvbnRhaW4oJy0gWyBdIFRhc2sgQycpO1xuICAgICAgZXhwZWN0KHJlc3VsdC50YXNrc0J5RGF0ZVsnMjAyMy0wMS0wMiddKS50b0NvbnRhaW4oJy0gWyBdIFRhc2sgQScpO1xuICAgICAgZXhwZWN0KHJlc3VsdC50YXNrc0J5RGF0ZVsnMjAyMy0wMS0wMiddKS50b0NvbnRhaW4oJy0gWyBdIFRhc2sgRCcpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBzdXBwcmVzcyB0YXNrcyBvdmVycmlkZGVuIGJ5IG5ld2VyIGNoZWNrZWQgdGFza3MnLCAoKSA9PiB7XG4gICAgICBjb25zdCBmaWxlQ29udGVudHM6IEZpbGVDb250ZW50W10gPSBbXG4gICAgICAgIHtcbiAgICAgICAgICBmaWxlTmFtZTogJzIwMjMtMDEtMDEnLFxuICAgICAgICAgIGxpbmVzOiBbJy0gWyBdIFRhc2sgQScsICctIFsgXSBUYXNrIEInXVxuICAgICAgICB9XG4gICAgICBdO1xuICAgICAgY29uc3QgbmV3ZXJDaGVja2VkID0gbmV3IFNldChbJ1Rhc2sgQSddKTtcbiAgICAgIFxuICAgICAgY29uc3QgcmVzdWx0ID0gcHJvY2Vzc1Rhc2tzV2l0aE92ZXJyaWRlcyhmaWxlQ29udGVudHMsIG5ld2VyQ2hlY2tlZCwgZmFsc2UpO1xuICAgICAgXG4gICAgICBleHBlY3QocmVzdWx0LmFsbFRhc2tzKS50b0hhdmVMZW5ndGgoMSk7XG4gICAgICBleHBlY3QocmVzdWx0LmFsbFRhc2tzKS50b0NvbnRhaW4oJy0gWyBdIFRhc2sgQicpO1xuICAgICAgZXhwZWN0KHJlc3VsdC5hbGxUYXNrcykubm90LnRvQ29udGFpbignLSBbIF0gVGFzayBBJyk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdjcmVhdGVUYXNrT3duZXJzaGlwTWFwJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgYXNzaWduIHRhc2tzIHRvIHRoZWlyIG1vc3QgcmVjZW50IGRhdGVzJywgKCkgPT4ge1xuICAgICAgY29uc3QgdGFza3NCeURhdGUgPSB7XG4gICAgICAgICcyMDIzLTAxLTAxJzogWyctIFsgXSBUYXNrIEEnLCAnLSBbIF0gVGFzayBCJ10sXG4gICAgICAgICcyMDIzLTAxLTAyJzogWyctIFsgXSBUYXNrIEEnLCAnLSBbIF0gVGFzayBDJ11cbiAgICAgIH07XG4gICAgICBcbiAgICAgIGNvbnN0IG93bmVyc2hpcCA9IGNyZWF0ZVRhc2tPd25lcnNoaXBNYXAodGFza3NCeURhdGUpO1xuICAgICAgXG4gICAgICBleHBlY3Qob3duZXJzaGlwLmdldCgnVGFzayBBJykpLnRvQmUoJzIwMjMtMDEtMDInKTtcbiAgICAgIGV4cGVjdChvd25lcnNoaXAuZ2V0KCdUYXNrIEInKSkudG9CZSgnMjAyMy0wMS0wMScpO1xuICAgICAgZXhwZWN0KG93bmVyc2hpcC5nZXQoJ1Rhc2sgQycpKS50b0JlKCcyMDIzLTAxLTAyJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBzaW5nbGUgZGF0ZSB3aXRoIG11bHRpcGxlIHRhc2tzJywgKCkgPT4ge1xuICAgICAgY29uc3QgdGFza3NCeURhdGUgPSB7XG4gICAgICAgICcyMDIzLTAxLTAxJzogWyctIFsgXSBUYXNrIEEnLCAnLSBbIF0gVGFzayBCJ11cbiAgICAgIH07XG4gICAgICBcbiAgICAgIGNvbnN0IG93bmVyc2hpcCA9IGNyZWF0ZVRhc2tPd25lcnNoaXBNYXAodGFza3NCeURhdGUpO1xuICAgICAgXG4gICAgICBleHBlY3Qob3duZXJzaGlwLmdldCgnVGFzayBBJykpLnRvQmUoJzIwMjMtMDEtMDEnKTtcbiAgICAgIGV4cGVjdChvd25lcnNoaXAuZ2V0KCdUYXNrIEInKSkudG9CZSgnMjAyMy0wMS0wMScpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnYnVpbGRGaW5hbFRhc2tzQnlEYXRlJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgYnVpbGQgZmluYWwgdGFza3MgcmVzcGVjdGluZyBvd25lcnNoaXAnLCAoKSA9PiB7XG4gICAgICBjb25zdCB0YXNrc0J5RGF0ZSA9IHtcbiAgICAgICAgJzIwMjMtMDEtMDEnOiBbJy0gWyBdIFRhc2sgQScsICctIFsgXSBUYXNrIEInXSxcbiAgICAgICAgJzIwMjMtMDEtMDInOiBbJy0gWyBdIFRhc2sgQScsICctIFsgXSBUYXNrIEMnXVxuICAgICAgfTtcbiAgICAgIGNvbnN0IHRhc2tPd25lcnNoaXAgPSBuZXcgTWFwKFtcbiAgICAgICAgWydUYXNrIEEnLCAnMjAyMy0wMS0wMiddLFxuICAgICAgICBbJ1Rhc2sgQicsICcyMDIzLTAxLTAxJ10sXG4gICAgICAgIFsnVGFzayBDJywgJzIwMjMtMDEtMDInXVxuICAgICAgXSk7XG4gICAgICBcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGJ1aWxkRmluYWxUYXNrc0J5RGF0ZSh0YXNrc0J5RGF0ZSwgdGFza093bmVyc2hpcCwgZmFsc2UpO1xuICAgICAgXG4gICAgICBleHBlY3QocmVzdWx0LmZpbmFsVGFza3NCeURhdGVbJzIwMjMtMDEtMDEnXSkudG9Db250YWluKCctIFsgXSBUYXNrIEInKTtcbiAgICAgIGV4cGVjdChyZXN1bHQuZmluYWxUYXNrc0J5RGF0ZVsnMjAyMy0wMS0wMiddKS50b0NvbnRhaW4oJy0gWyBdIFRhc2sgQScpO1xuICAgICAgZXhwZWN0KHJlc3VsdC5maW5hbFRhc2tzQnlEYXRlWycyMDIzLTAxLTAyJ10pLnRvQ29udGFpbignLSBbIF0gVGFzayBDJyk7XG4gICAgICBleHBlY3QocmVzdWx0LmZpbmFsVGFza3NCeURhdGVbJzIwMjMtMDEtMDEnXSkubm90LnRvQ29udGFpbignLSBbIF0gVGFzayBBJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHNvcnQgdGFza3Mgd2hlbiByZXF1ZXN0ZWQnLCAoKSA9PiB7XG4gICAgICBjb25zdCB0YXNrc0J5RGF0ZSA9IHtcbiAgICAgICAgJzIwMjMtMDEtMDEnOiBbJy0gWyBdIFplYnJhIHRhc2snLCAnLSBbIF0gQXBwbGUgdGFzayddXG4gICAgICB9O1xuICAgICAgY29uc3QgdGFza093bmVyc2hpcCA9IG5ldyBNYXAoW1xuICAgICAgICBbJ1plYnJhIHRhc2snLCAnMjAyMy0wMS0wMSddLFxuICAgICAgICBbJ0FwcGxlIHRhc2snLCAnMjAyMy0wMS0wMSddXG4gICAgICBdKTtcbiAgICAgIFxuICAgICAgY29uc3QgcmVzdWx0ID0gYnVpbGRGaW5hbFRhc2tzQnlEYXRlKHRhc2tzQnlEYXRlLCB0YXNrT3duZXJzaGlwLCB0cnVlKTtcbiAgICAgIFxuICAgICAgZXhwZWN0KHJlc3VsdC5maW5hbFRhc2tzQnlEYXRlWycyMDIzLTAxLTAxJ11bMF0pLnRvQmUoJy0gWyBdIEFwcGxlIHRhc2snKTtcbiAgICAgIGV4cGVjdChyZXN1bHQuZmluYWxUYXNrc0J5RGF0ZVsnMjAyMy0wMS0wMSddWzFdKS50b0JlKCctIFsgXSBaZWJyYSB0YXNrJyk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdidWlsZE5vbkdyb3VwZWRUYXNrcycsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGRlZHVwbGljYXRlIHRhc2tzJywgKCkgPT4ge1xuICAgICAgY29uc3QgYWxsVGFza3MgPSBbJy0gWyBdIFRhc2sgQScsICctIFsgXSBUYXNrIEInLCAnLSBbIF0gVGFzayBBJ107XG4gICAgICBcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGJ1aWxkTm9uR3JvdXBlZFRhc2tzKGFsbFRhc2tzLCBmYWxzZSk7XG4gICAgICBcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvSGF2ZUxlbmd0aCgyKTtcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvQ29udGFpbignLSBbIF0gVGFzayBBJyk7XG4gICAgICBleHBlY3QocmVzdWx0KS50b0NvbnRhaW4oJy0gWyBdIFRhc2sgQicpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBzb3J0IHRhc2tzIHdoZW4gcmVxdWVzdGVkJywgKCkgPT4ge1xuICAgICAgY29uc3QgYWxsVGFza3MgPSBbJy0gWyBdIFplYnJhIHRhc2snLCAnLSBbIF0gQXBwbGUgdGFzayddO1xuICAgICAgXG4gICAgICBjb25zdCByZXN1bHQgPSBidWlsZE5vbkdyb3VwZWRUYXNrcyhhbGxUYXNrcywgdHJ1ZSk7XG4gICAgICBcbiAgICAgIGV4cGVjdChyZXN1bHRbMF0pLnRvQmUoJy0gWyBdIEFwcGxlIHRhc2snKTtcbiAgICAgIGV4cGVjdChyZXN1bHRbMV0pLnRvQmUoJy0gWyBdIFplYnJhIHRhc2snKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIGVtcHR5IHRhc2sgbGlzdCcsICgpID0+IHtcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGJ1aWxkTm9uR3JvdXBlZFRhc2tzKFtdLCBmYWxzZSk7XG4gICAgICBleHBlY3QocmVzdWx0KS50b0hhdmVMZW5ndGgoMCk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdnZW5lcmF0ZU91dHB1dCcsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGdlbmVyYXRlIGdyb3VwZWQgb3V0cHV0IHdpdGggZGF0ZSBoZWFkaW5ncycsICgpID0+IHtcbiAgICAgIGNvbnN0IGZpbmFsVGFza3NCeURhdGUgPSB7XG4gICAgICAgICcyMDIzLTAxLTAxJzogWyctIFsgXSBUYXNrIEInXSxcbiAgICAgICAgJzIwMjMtMDEtMDInOiBbJy0gWyBdIFRhc2sgQScsICctIFsgXSBUYXNrIEMnXVxuICAgICAgfTtcbiAgICAgIGNvbnN0IGFsbEZpbmFsVGFza3MgPSBbJy0gWyBdIFRhc2sgQicsICctIFsgXSBUYXNrIEEnLCAnLSBbIF0gVGFzayBDJ107XG4gICAgICBcbiAgICAgIGNvbnN0IG91dHB1dCA9IGdlbmVyYXRlT3V0cHV0KGZpbmFsVGFza3NCeURhdGUsIGFsbEZpbmFsVGFza3MsIGZhbHNlKTtcbiAgICAgIFxuICAgICAgZXhwZWN0KG91dHB1dCkudG9Db250YWluKCcjIyMgVW5jaGVja2VkIFRhc2tzJyk7XG4gICAgICBleHBlY3Qob3V0cHV0KS50b0NvbnRhaW4oJyMjIyMgMjAyMy0wMS0wMScpO1xuICAgICAgZXhwZWN0KG91dHB1dCkudG9Db250YWluKCcjIyMjIDIwMjMtMDEtMDInKTtcbiAgICAgIGV4cGVjdChvdXRwdXQpLnRvQ29udGFpbignLSBbIF0gVGFzayBBJyk7XG4gICAgICBleHBlY3Qob3V0cHV0KS50b0NvbnRhaW4oJy0gWyBdIFRhc2sgQicpO1xuICAgICAgZXhwZWN0KG91dHB1dCkudG9Db250YWluKCctIFsgXSBUYXNrIEMnKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgZ2VuZXJhdGUgcmV2ZXJzZSBjaHJvbm9sb2dpY2FsIG91dHB1dCcsICgpID0+IHtcbiAgICAgIGNvbnN0IGZpbmFsVGFza3NCeURhdGUgPSB7XG4gICAgICAgICcyMDIzLTAxLTAxJzogWyctIFsgXSBUYXNrIEInXSxcbiAgICAgICAgJzIwMjMtMDEtMDInOiBbJy0gWyBdIFRhc2sgQSddXG4gICAgICB9O1xuICAgICAgY29uc3QgYWxsRmluYWxUYXNrcyA9IFsnLSBbIF0gVGFzayBCJywgJy0gWyBdIFRhc2sgQSddO1xuICAgICAgXG4gICAgICBjb25zdCBvdXRwdXQgPSBnZW5lcmF0ZU91dHB1dChmaW5hbFRhc2tzQnlEYXRlLCBhbGxGaW5hbFRhc2tzLCB0cnVlKTtcbiAgICAgIFxuICAgICAgY29uc3QgcG9zMjAyM18wMV8wMiA9IG91dHB1dC5pbmRleE9mKCcjIyMjIDIwMjMtMDEtMDInKTtcbiAgICAgIGNvbnN0IHBvczIwMjNfMDFfMDEgPSBvdXRwdXQuaW5kZXhPZignIyMjIyAyMDIzLTAxLTAxJyk7XG4gICAgICBcbiAgICAgIGV4cGVjdChwb3MyMDIzXzAxXzAyKS50b0JlTGVzc1RoYW4ocG9zMjAyM18wMV8wMSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBlbXB0eSB0YXNrcycsICgpID0+IHtcbiAgICAgIGNvbnN0IG91dHB1dCA9IGdlbmVyYXRlT3V0cHV0KHt9LCBbXSwgZmFsc2UpO1xuICAgICAgXG4gICAgICBleHBlY3Qob3V0cHV0KS50b0JlKCcjIyMgVW5jaGVja2VkIFRhc2tzXFxuXFxuJyk7XG4gICAgfSk7XG4gIH0pO1xufSk7Il19